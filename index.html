<!-- Metrics Dashboard -->
<section class="container">
  <h2 style="text-align:center;">Bitcoin Network Metrics</h2>
  <div class="metrics-dashboard">
    <!-- Bitcoin Price -->
    <div class="metric-card">
      <h3>Bitcoin Price (GBP)</h3>
      <div id="bitcoinPrice" class="metric-value">Loading...</div>
      <p class="metric-description">Live market price in GBP.</p>
    </div>

    <!-- Pending Transactions -->
    <div class="metric-card">
      <h3>Pending Transactions</h3>
      <div id="pendingTx" class="metric-value">Loading...</div>
      <p class="metric-description">Number of unconfirmed Bitcoin transactions.</p>
    </div>

    <!-- Recommended Fee -->
    <div class="metric-card">
      <h3>Recommended Fee</h3>
      <div id="feeEstimate" class="metric-value">Loading...</div>
      <p class="metric-description">Sat/vByte for next-block confirmation.</p>
    </div>

    <!-- Latest Block Transactions -->
    <div class="metric-card">
      <h3>Latest Block</h3>
      <div id="blockTx" class="metric-value">Loading...</div>
      <p class="metric-description">Transactions included in the latest block.</p>
    </div>

    <!-- Network Hashrate -->
    <div class="metric-card">
      <h3>Network Hashrate</h3>
      <div id="hashrate" class="metric-value">Loading...</div>
      <p class="metric-description">3-day average security of the Bitcoin network.</p>
    </div>

    <!-- Miner Fees (24h) -->
    <div class="metric-card">
      <h3>Miner Fees (24h)</h3>
      <div id="minerFees" class="metric-value">Loading...</div>
      <p class="metric-description">Total BTC paid in fees over the last 24h.</p>
    </div>
  </div>
</section>

<!-- Scripts -->
<script>
  // Fetch Bitcoin Price in GBP
  async function fetchBitcoinPriceInGBP() {
    try {
      const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=gbp');
      const data = await response.json();
      document.getElementById('bitcoinPrice').innerText = `Â£${data.bitcoin.gbp.toLocaleString()}`;
    } catch (error) {
      document.getElementById('bitcoinPrice').innerText = 'Unavailable';
    }
  }

  // Fetch Pending Transactions
  async function fetchPendingTransactions() {
    try {
      const res = await fetch("https://mempool.space/api/mempool");
      const data = await res.json();
      document.getElementById("pendingTx").innerText = data.count.toLocaleString();
    } catch {
      document.getElementById("pendingTx").innerText = "Unavailable";
    }
  }

  // Fetch Recommended Fee
  async function fetchFeeEstimate() {
    try {
      const res = await fetch("https://mempool.space/api/v1/fees/recommended");
      const data = await res.json();
      document.getElementById("feeEstimate").innerText = data.fastestFee + " sat/vB";
    } catch {
      document.getElementById("feeEstimate").innerText = "Unavailable";
    }
  }

  // Fetch Latest Block Transactions
  async function fetchLatestBlock() {
    try {
      const res = await fetch("https://mempool.space/api/blocks");
      const data = await res.json();
      document.getElementById("blockTx").innerText = data[0].tx_count.toLocaleString();
    } catch {
      document.getElementById("blockTx").innerText = "Unavailable";
    }
  }

  // Fetch Network Hashrate (3-day avg)
  async function fetchHashrate() {
    try {
      const res = await fetch("https://mempool.space/api/v1/mining/hashrate/3d");
      const data = await res.json();
      const latest = data[data.length - 1].avgHashrate;
      document.getElementById("hashrate").innerText = (latest / 1e18).toFixed(2) + " EH/s";
    } catch {
      document.getElementById("hashrate").innerText = "Unavailable";
    }
  }

  // Fetch Miner Fees (24h)
  async function fetchMinerFees() {
    try {
      const res = await fetch("https://mempool.space/api/v1/mining/blocks/fees/24h");
      const data = await res.json();
      document.getElementById("minerFees").innerText = data.total.toFixed(2) + " BTC";
    } catch {
      document.getElementById("minerFees").innerText = "Unavailable";
    }
  }

  // Initial load
  fetchBitcoinPriceInGBP();
  fetchPendingTransactions();
  fetchFeeEstimate();
  fetchLatestBlock();
  fetchHashrate();
  fetchMinerFees();

  // Refresh every 1 minute
  setInterval(fetchBitcoinPriceInGBP, 60000);
  setInterval(fetchPendingTransactions, 60000);
  setInterval(fetchFeeEstimate, 60000);
  setInterval(fetchLatestBlock, 60000);
  setInterval(fetchHashrate, 60000);
  setInterval(fetchMinerFees, 60000);
</script>
